{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/claude-code-toolkit/features.schema.json",
  "title": "Claude Code Features Tracking",
  "description": "Schema for tracking feature implementation status with redâ†’green pattern",
  "type": "object",
  "required": ["metadata", "features"],
  "properties": {
    "metadata": {
      "type": "object",
      "required": ["project_name", "created_at", "last_updated", "total_features", "completed"],
      "properties": {
        "project_name": {
          "type": "string",
          "description": "Name of the project"
        },
        "created_at": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp when features.json was created"
        },
        "last_updated": {
          "type": "string",
          "format": "date-time",
          "description": "ISO 8601 timestamp of last update"
        },
        "total_features": {
          "type": "integer",
          "minimum": 0,
          "description": "Total number of features"
        },
        "completed": {
          "type": "integer",
          "minimum": 0,
          "description": "Number of completed features"
        }
      }
    },
    "features": {
      "type": "array",
      "description": "Array of features in progress or pending",
      "items": {
        "$ref": "#/definitions/feature"
      }
    },
    "completed_features": {
      "type": "array",
      "description": "Array of completed features (optional, for history)",
      "items": {
        "$ref": "#/definitions/feature"
      }
    }
  },
  "definitions": {
    "feature": {
      "type": "object",
      "required": ["id", "name", "description", "acceptance_criteria", "passes"],
      "properties": {
        "id": {
          "type": "string",
          "pattern": "^F[0-9]{3,}$",
          "description": "Unique feature ID (e.g., F001, F002)"
        },
        "name": {
          "type": "string",
          "minLength": 1,
          "description": "Short feature name"
        },
        "description": {
          "type": "string",
          "description": "Detailed description of what this feature does"
        },
        "acceptance_criteria": {
          "type": "array",
          "minItems": 1,
          "description": "List of testable acceptance criteria",
          "items": {
            "type": "object",
            "required": ["criterion", "passes"],
            "properties": {
              "criterion": {
                "type": "string",
                "minLength": 1,
                "description": "Specific testable condition"
              },
              "passes": {
                "type": "boolean",
                "description": "Whether this criterion passes verification"
              },
              "verified_at": {
                "type": ["string", "null"],
                "format": "date-time",
                "description": "ISO 8601 timestamp when verified"
              }
            }
          }
        },
        "dependencies": {
          "type": "array",
          "description": "Array of feature IDs this feature depends on",
          "items": {
            "type": "string",
            "pattern": "^F[0-9]{3,}$"
          }
        },
        "priority": {
          "type": "string",
          "enum": ["critical", "high", "medium", "low"],
          "description": "Feature priority level"
        },
        "passes": {
          "type": "boolean",
          "description": "Overall feature pass status - must be false until ALL criteria verified"
        },
        "branch": {
          "type": ["string", "null"],
          "description": "Git branch name if feature developed in branch"
        },
        "notes": {
          "type": "string",
          "description": "Additional notes or blockers"
        },
        "last_updated": {
          "type": ["string", "null"],
          "format": "date-time",
          "description": "ISO 8601 timestamp of last update"
        },
        "prd_section": {
          "type": "string",
          "description": "PRD section reference (e.g., '3.2.1')"
        },
        "prd_requirement": {
          "type": "string",
          "description": "Description from PRD"
        },
        "constraints": {
          "type": "object",
          "description": "Implementation constraints",
          "properties": {
            "hard": {
              "type": "array",
              "items": {"type": "string"},
              "description": "Hard constraints that cannot be violated"
            },
            "soft": {
              "type": "array",
              "items": {"type": "string"},
              "description": "Soft preferences to optimize for"
            },
            "anti_patterns": {
              "type": "array",
              "items": {"type": "string"},
              "description": "Patterns to explicitly avoid"
            }
          }
        },
        "validation": {
          "type": "object",
          "description": "Validation tests",
          "properties": {
            "performance_test": {
              "type": "string",
              "description": "Path to performance test"
            },
            "resource_test": {
              "type": "string",
              "description": "Path to resource usage test"
            }
          }
        }
      }
    }
  }
}
